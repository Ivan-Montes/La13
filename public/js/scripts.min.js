/*global $ */
function fn_CreateSmoothMove(pLinkInit, pLinkFinal, pTime) {
    'use strict';
    var vWidth = $(window).width();
    if (vWidth > 767) { pTime = pTime - 500; }
    $(pLinkInit).click(function () {
        $("html,body").animate({scrollTop: $(pLinkFinal).offset().top}, pTime);
    });
}
function fn_LoadSmoothMove() {
    'use strict';
    fn_CreateSmoothMove("#aBody", "body", 1500);
    fn_CreateSmoothMove("#asAbout", "#sAbout", 1500);
    fn_CreateSmoothMove("#asServices", "#sServices", 1500);
    fn_CreateSmoothMove("#asQuality", "#sQuality", 1500);
    fn_CreateSmoothMove("#asSchedule", "#sSchedule", 1500);
    fn_CreateSmoothMove("#asResults", "#sResults", 2000);
    fn_CreateSmoothMove("#asProposals", "#sProposals", 2500);
    fn_CreateSmoothMove("#asLoca", "#sMap", 2500);
    fn_CreateSmoothMove("#aToHome", "body", 2000);
    fn_CreateSmoothMove("#aToAbout", "#sAbout", 1500);
    fn_CreateSmoothMove("#aResultsToMap", "#sMap", 1500);
}
function fn_CloseNavMenuOnClick() {
    'use strict';
    var vMenu = $("#navMenu"), vHam = $("#inHam");
    vMenu.click(function (event) {
        var vClicked = event.target.tagName;
        if (vClicked === 'A') {
            vHam.prop('checked', false);
            vHam.attr("aria-checked", "false");
            vMenu.attr("aria-hidden", "true");
        }
    });
}
function fn_ShowToHomeButton() {
    'use strict';
    var vNoReturnPoint = $("#sSchedule").offset().top - $(window).height();
    $(window).scroll(function () {
        if ($(this).scrollTop() > vNoReturnPoint) {
            $("#aToHome").addClass("anime-prestige--is-active");
        } else {
            $("#aToHome").removeClass("anime-prestige--is-active");
        }
    });
}
function fn_AnimateNumber(pTarget) {
    'use strict';
    $(pTarget).each(function () {
        $(this).prop('Counter', 0).animate({
            Counter: $(this).text()
        }, {
            duration: 3000,
            easing: 'swing',
            step: function (now) {
                $(this).text(Math.ceil(now));
            }
        });
    });
}
function fn_SetValueDefParam(pParam, pDefaultValue) {
    'use strict';
    return typeof pParam !== 'undefined' ? pParam : pDefaultValue;
}
function fn_EvaluateDistanceToObject(pTarget) {
    'use strict';
    var vResultado = $(pTarget).offset().top - $(window).height();
    if (0  > vResultado) {
        return $(pTarget).parent().offset().top - $(window).height();
    } else {
        return vResultado;
    }
}
function fn_FirstAppearsOnScreen(pTarget, pFunction, pDistanceExtra, pOption) {
    'use strict';
    pDistanceExtra = fn_SetValueDefParam(pDistanceExtra, 0);
    var vSentry = false, vDistanceWhenAppears = fn_EvaluateDistanceToObject(pTarget) + pDistanceExtra;
    $(window).scroll(function () {
        if ($(this).scrollTop() > vDistanceWhenAppears) {
            if (vSentry === false) {
                pFunction(pTarget, pOption);
                vSentry = true;
            }
        }
    });
}
function fn_LoadAnimateNumber() {
    'use strict';
    fn_FirstAppearsOnScreen("#chartResult01", fn_AnimateNumber);
    fn_FirstAppearsOnScreen("#chartResult02", fn_AnimateNumber);
    fn_FirstAppearsOnScreen("#chartResult03", fn_AnimateNumber);
    fn_FirstAppearsOnScreen("#chartResult04", fn_AnimateNumber);
}
function fn_ChangeStrokeDashArray(pTarget, pValuePropStrokeDash) {
    'use strict';
    $(pTarget).css("stroke-dasharray", pValuePropStrokeDash);
}
function fn_AnimatedStrokeDashArray(pTarget) {
    'use strict';
    var vValueInitStrokeDashArray = "1px,392px", vValuePropStrokeDash = $(pTarget).css("stroke-dasharray");
    $(pTarget).css("stroke-dasharray", vValueInitStrokeDashArray);
    fn_FirstAppearsOnScreen(pTarget, fn_ChangeStrokeDashArray, 0, vValuePropStrokeDash);
}
function fn_LoadAnimatedStrokeDashArray() {
    'use strict';
    fn_AnimatedStrokeDashArray("#chartCircle01");
    fn_AnimatedStrokeDashArray("#chartCircle02");
    fn_AnimatedStrokeDashArray("#chartCircle03");
    fn_AnimatedStrokeDashArray("#chartCircle04");
}
function fn_CallSpinner(pTargetImg) {
    'use strict';
    var vDataTargetDad = $(pTargetImg).parent(), vHposition = $(window).height() / 5, vSpinner = "0";
    $(vDataTargetDad).append("<div id='modalloading' role='progressbar' aria-label='Cargando la Imagen' aria-valuemin='0' class='modal__loading js-modal-loading'></div>");
    vSpinner = $("#modalloading");
    if (($(window).width() < 1024) && ($(vDataTargetDad).prop("tagName") === "FIGURE")) {
        $(vSpinner).css({"position": "fixed", "top": vHposition + "px"});
    }
    return vSpinner;
}
function fn_ByeByeSpinner(pSpinner) {
    'use strict';
    $(pSpinner).fadeOut(3000);
    $(pSpinner).delay(4000).remove();
}
function fn_WaitForLoad(pDataTargetImg) {
    'use strict';
    $(pDataTargetImg).hide();
    var vSpinner = fn_CallSpinner(pDataTargetImg), vSentry = false, vDataTargetDad = $(pDataTargetImg).parent();

    $(pDataTargetImg).on({
        "load": function () {
            $(pDataTargetImg).fadeIn(2000);
            fn_ByeByeSpinner(vSpinner);
        },
        "error": function () {
            if (vSentry === false) {
                fn_ByeByeSpinner(vSpinner);
                $("<div>", {"id": "btAlert-warning", "class": "js-alert-warning",  "role": "alert", "html": "<p>Parece que ha habido un problema, lo sentimos.</p>"}).appendTo(vDataTargetDad);
                var vWarningBox = $(".js-alert-warning");
                $(vWarningBox).css({"padding": "15px", "margin-bottom": "20px", "border-radius": "4px", "text-shadow": "1px 1px 0px #808080", "background-color": "#f6511d", "font-weight": "bold", "background-image": "linear-gradient(#f6511d,#fdd600)", "font-size": "1.2em"});
                setTimeout(function () {
                    $(vWarningBox).each(function () {
                        $(this).remove();
                    });
                }, 7000);
                vSentry = true;
                $(pDataTargetImg).off("error");
            }
        }
    });
}
function fn_LazyLoad(pDataTargetImg) {
    'use strict';
    $(pDataTargetImg).each(function () {
        var vDataSrc = $(this).attr("data-src"), vDataSrcset = $(this).attr("data-srcset"), vDataSizes = $(this).attr("data-sizes");
        $(this).attr("src", vDataSrc);
        $(this).attr("srcset", vDataSrcset);
        $(this).attr("sizes", vDataSizes);
    });
}
function fn_ClickImgForLoad() {
    'use strict';
    $(".js-load-on-click").on("click", function () {
        var vDataTargetImg = $(this).attr("data-target") + " " + "img";
        fn_LazyLoad(vDataTargetImg);
        fn_WaitForLoad(vDataTargetImg);
    });
}
function fn_PaintNacional(pClicked, pReplyParsed) {
    'use strict';
    var vLotResult = "", i = 0;
    $("#pResultNacionalDay").html(pReplyParsed[0]);
    $("#pResultNacional").html("NÃºmero Premiado:" + "&nbsp;" + pReplyParsed[1]);
}
function fn_PaintPrimi(pClicked, pReplyParsed) {
    'use strict';
    var vLotResult = "", i = 0;
    $(pClicked).find(".js-raffle-day").html(pReplyParsed[0]);
    for (i = 1; i < 7; i += 1) {
        vLotResult += pReplyParsed[i];
    }
    $(pClicked).find(".js-raffle").html(vLotResult);
    $(pClicked).find(".js-raffle-re").html("Complementario:" + "&nbsp;" + pReplyParsed[7]);
    $(pClicked).find(".js-raffle-co").html("Reintegro:" + "&nbsp;" + pReplyParsed[8]);
    if (pReplyParsed.length > 8) {
        $(pClicked).find(".js-raffle-bo").html("Joker:" + "&nbsp;" + pReplyParsed[9]);
    }
}
function fn_PaintLoto_6y2(pClicked, pReplyParsed) {
    'use strict';
    var vLotResult = "", i = 0;
    $(pClicked).find(".js-raffle-day").html(pReplyParsed[0]);
    for (i = 1; i < 7; i += 1) {
        vLotResult += pReplyParsed[i];
    }
    $(pClicked).find(".js-raffle").html(vLotResult);
    $(pClicked).find(".js-raffle-re").html("Complementario:" + "&nbsp;" + pReplyParsed[7]);
    $(pClicked).find(".js-raffle-co").html("Reintegro:" + "&nbsp;" + pReplyParsed[8]);
}
function fn_PaintLoto_5y1o2(pClicked, pReplyParsed) {
    'use strict';
    var vLotResult = "", i = 0, vResultExtraBalls = 0, vExtraTextForResult = "Reintegro";
    $(pClicked).find(".js-raffle-day").html(pReplyParsed[0]);
    for (i = 1; i < 6; i += 1) {
        vLotResult += pReplyParsed[i];
    }
    $(pClicked).find(".js-raffle").html(vLotResult);
    for (i = 7; i < pReplyParsed.length; i += 1) {
        vResultExtraBalls += pReplyParsed[i];
    }
    if (pReplyParsed.length > 7) {
        vExtraTextForResult = "Estrellas";
    }
    $(pClicked).find(".js-raffle-re").html(vExtraTextForResult + ":" + "&nbsp;" + vResultExtraBalls);
}
function fn_PaintEuro(pClicked, pReplyParsed) {
    'use strict';
    var vLotResult = "", i = 0, vResultExtraBalls = "", vExtraTextForResult = "Estrellas", vResultBonus = 0;
    $(pClicked).find(".js-raffle-day").html(pReplyParsed[0]);
    for (i = 1; i < 6; i += 1) {
        vLotResult += pReplyParsed[i];
    }
    $(pClicked).find(".js-raffle").html(vLotResult);
    for (i = 6; i < 8; i += 1) {
        vResultExtraBalls += pReplyParsed[i];
    }
    $(pClicked).find(".js-raffle-re").html(vExtraTextForResult + ":" + "&nbsp;" + vResultExtraBalls);
    if (pReplyParsed.length > 8) {
        for (i = 8; i < pReplyParsed.length; i += 1) {
            vResultBonus = pReplyParsed[i];
        }
        $(pClicked).find(".js-raffle-bo").html("Millon" + ":" + "&nbsp;" + vResultBonus);
    }
}
function fn_PaintQuinis(pClicked, pReplyParsed) {
    'use strict';
    var vLotResult = "", i = 0, vHalfElements = 0, vPlaceInDomForTeams = $(pClicked).find(".js-participants-teams"), vPlaceInDomForResults = $(pClicked).find(".js-participants-results"), vPlaceInDomForDay = $(pClicked).find(".js-participants-results-day");
    $(vPlaceInDomForDay).html(pReplyParsed[0]);
    vHalfElements = ((pReplyParsed.length) - 1) / 2;
    for (i = 1; i < vHalfElements + 1; i += 1) {
        $("<li>").html(pReplyParsed[i]).appendTo(vPlaceInDomForTeams);
    }
    for (i = vHalfElements + 1; i < pReplyParsed.length; i += 1) {
        $("<li>").html(pReplyParsed[i]).appendTo(vPlaceInDomForResults);
    }
}
function fn_DispatchPaintResult(pClicked, pDataNameClicked, pReply) {
    'use strict';
    switch (pDataNameClicked) {
    case "nacional":
        fn_PaintNacional(pClicked, pReply);
        break;
    case "primitiva":
        fn_PaintPrimi(pClicked, pReply);
        break;
    case "bonoloto":
    case "lototurf":
        fn_PaintLoto_6y2(pClicked, pReply);
        break;
    case "gordo":
        fn_PaintLoto_5y1o2(pClicked, pReply);
        break;
    case "euromillones":
        fn_PaintEuro(pClicked, pReply);
        break;
    case "quiniela":
    case "quinigol":
        fn_PaintQuinis(pClicked, pReply);
        break;
    case "quintuple":
        fn_PaintQuinis(pClicked, pReply);
        break;
    default:
        break;
    }
}
function fn_ChangeAriaExpanded(pElement) {
    'use strict';
    var vChosenOne = $(pElement).find("[aria-expanded='false']");
    vChosenOne.attr("aria-expanded", "true");
}
function fn_QueryResults() {
    'use strict';
    $(".js-link-result").one("click", function (e) {
        e.preventDefault();
        var vClicked = $(this), vDataNameClicked = "", vJsonReply = "", vSpin = "";
        vDataNameClicked = vClicked.attr("data-name");
        $.ajax({
            url: "../private/controller.php",
            type: "POST",
            data: {"data_name_attr" : vDataNameClicked},
            timeout: 15000,
            beforeSend: function () {
                vSpin = fn_CallSpinner(vClicked);
            },
            success: function (r) {
                vJsonReply = JSON.parse(r);
                fn_DispatchPaintResult(vClicked, vDataNameClicked, vJsonReply);
                fn_ChangeAriaExpanded(vClicked);
            },
            error: function () {
            },
            complete: function () {
                fn_ByeByeSpinner(vSpin);
            }
        });
    });
}
function fn_UpdateYear() {
    'use strict';
    var vDate = new Date(), vYear = vDate.getFullYear();
    $("#spDate").text(vYear);
}
function fn_AddElement() {
    'use strict';
    $(window).on("load", function () {
        $(".js-ifr__map").attr("src", "https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3027.864144484447!2d-3.194128485187277!3d40.63287795039026!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0xd43ac623c339787%3A0xc463188736917148!2sAdministracion+13+La+Abeja+del+Oro!5e0!3m2!1ses!2ses!4v1478884454749");
    });
}
function fn_GoogleAnalytics() {
    'use strict';
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-112022100-1', 'auto');
ga('send', 'pageview');           
}
function fn_ClickWarning() {
    'use strict';
    $("#dCookiesWarning-btn").on("click", function () {
        fn_GoogleAnalytics();
    });
}
function fn_DinamicDecoEnd(pTarget, pClass) {
    'use strict';
    $(pTarget).removeClass(pClass);
}
function fn_DinamicDecoInit(pTarget, pClass) {
    'use strict';
    var vDistance = 0;
    if ($(window).width() > 768) {
        vDistance = 200;
    }
    $(pTarget).addClass(pClass);
    $.each($(pTarget), function (key, value) {
        fn_FirstAppearsOnScreen(value, fn_DinamicDecoEnd, vDistance, pClass);
    });
}
function fn_LetsDeco() {
    'use strict';
    fn_DinamicDecoInit(".js-deco-column", "deco-column-empty");
    fn_DinamicDecoInit(".js-drawer__schedule", "drawer__schedule--empty");
    fn_DinamicDecoInit(".js-palote", "palote--empty");
    fn_DinamicDecoInit(".js-deco-line", "deco-line--empty");
}
$(function () {
    'use strict';
    fn_LoadSmoothMove();
    fn_CloseNavMenuOnClick();
    fn_ShowToHomeButton();
    fn_LoadAnimateNumber();
    fn_LoadAnimatedStrokeDashArray();
    fn_ClickImgForLoad();
    fn_QueryResults();
    fn_UpdateYear();
    fn_AddElement();
    fn_ClickWarning();
    fn_LetsDeco();
});